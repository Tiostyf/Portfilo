<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Rishabh Singh | Portfolio</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"/>
  <style>
    :root{--bg:#0f0f1e;--card:#1a1a2e;--primary:#00ffff;--text:#e0e0ff;--gray:#aaa;}
    *{margin:0;padding:0;box-sizing:border-box;}
    body{font-family:'Inter',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;}
    #particles-js{position:fixed;width:100%;height:100%;top:0;left:0;z-index:-1;}

    nav{position:fixed;top:15px;left:50%;transform:translateX(-50%);background:rgba(0,0,0,0.6);padding:12px 30px;border-radius:50px;z-index:1000;backdrop-filter:blur(10px);}
    nav a{color:white;margin:0 20px;text-decoration:none;font-weight:600;}
    nav a:hover{color:var(--primary);}

    header{height:100vh;display:flex;align-items:center;justify-content:center;text-align:center;flex-direction:column;}
    .hero h1{font-size:4.5rem;font-weight:900;background:linear-gradient(90deg,#00ffff,#00ffaa);-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
    .hero p{font-size:1.5rem;color:var(--gray);margin:20px 0;}
    .btn{display:inline-block;padding:15px 40px;margin:10px;background:transparent;border:2px solid var(--primary);color:var(--primary);border-radius:50px;text-decoration:none;font-weight:700;transition:0.4s;}
    .btn:hover{background:var(--primary);color:#000;transform:scale(1.1);}

    section{padding:100px 5%;text-align:center;}
    h2{font-size:3rem;margin-bottom:60px;background:linear-gradient(90deg,#00ffff,#ff00ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent;}

    .upload-box{max-width:800px;margin:0 auto;background:var(--card);padding:50px;border-radius:20px;border:3px dashed var(--primary);}
    .upload-label{cursor:pointer;background:var(--primary);color:#000;padding:20px 50px;border-radius:50px;font-weight:900;display:inline-block;}
    input[type=file]{display:none;}

    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:25px;max-width:1400px;margin:50px auto;padding:0 20px;}
    .card{background:var(--card);border-radius:15px;overflow:hidden;box-shadow:0 10px 30px rgba(0,255,255,0.2);transition:0.4s;cursor:pointer;}
    .card:hover{transform:translateY(-15px);box-shadow:0 20px 40px rgba(0,255,255,0.4);}
    .card img,.card video,.card iframe{width:100%;height:250px;object-fit:cover;background:#000;}
    .card iframe{border:none;}
    .card-info{padding:15px;background:rgba(0,0,0,0.8);}
    .card-title{font-weight:700;color:white;}
    .card-size{color:var(--gray);font-size:0.9rem;}

    .modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.98);z-index:9999;align-items:center;justify-content:center;padding:20px;}
    .modal.active{display:flex;}
    .modal-content{max-width:95%;max-height:95%;background:#000;border-radius:15px;overflow:hidden;position:relative;}
    .modal-content img,.modal-content video,.modal-content iframe{width:100%;height:100%;object-fit:contain;}
    .close{position:absolute;top:15px;right:20px;font-size:3rem;color:white;cursor:pointer;background:rgba(0,0,0,0.7);width:60px;height:60px;border-radius:50%;display:grid;place-items:center;z-index:10;}
    .download{position:absolute;bottom:20px;right:20px;background:var(--primary);color:#000;padding:12px 25px;border-radius:50px;font-weight:bold;cursor:pointer;}

    .contact-form{max-width:700px;margin:0 auto;background:var(--card);padding:40px;border-radius:20px;}
    input,textarea{width:100%;padding:15px;margin:10px 0;background:rgba(0,0,0,0.4);border:1px solid var(--primary);border-radius:10px;color:white;outline:none;}
    button{background:var(--primary);color:#000;border:none;padding:15px 40px;border-radius:50px;font-weight:900;cursor:pointer;}

    @media(max-width:768px){
      .hero h1{font-size:3rem;}
      nav{top:10px;padding:10px 15px;}
      nav a{margin:0 10px;font-size:0.9rem;}
      .grid{grid-template-columns:1fr;padding:0 10px;}
    }
  </style>
</head>
<body>
  <div id="particles-js"></div>

  <nav>
    <a href="#home">Home</a>
    <a href="#upload">Upload</a>
    <a href="#gallery">Gallery</a>
    <a href="#contact">Contact</a>
  </nav>

  <header id="home">
    <div class="hero">
      <h1>RISHABH SINGH</h1>
      <p>Senior Full-Stack MERN Developer</p>
      <a href="#upload" class="btn">Upload Files</a>
      <a href="#contact" class="btn">Contact Me</a>
    </div>
  </header>

  <section id="upload">
    <h2>Upload Any File</h2>
    <div class="upload-box">
      <label class="upload-label">
        Click to Upload (50MB Max)
        <input type="file" id="fileInput"/>
      </label>
    </div>
  </section>

  <section id="gallery">
    <h2>Your Files</h2>
    <div class="grid" id="feed">Loading files...</div>
  </section>

  <section id="contact">
    <h2>Get In Touch</h2>
    <div class="contact-form">
      <form id="contactForm">
        <input type="text" name="name" placeholder="Name" required/>
        <input type="email" name="email" placeholder="Email" required/>
        <input type="text" name="subject" placeholder="Subject"/>
        <textarea name="message" rows="5" placeholder="Message" required></textarea>
        <button type="submit">Send Message</button>
      </form>
      <p id="status" style="margin-top:20px;color:var(--primary);font-weight:bold;"></p>
    </div>
  </section>

  <!-- FULL SCREEN MODAL -->
  <div class="modal" id="modal">
    <div class="close" onclick="closeModal()">X</div>
    <div class="download" onclick="downloadFile()">Download</div>
    <div class="modal-content" id="modalContent"></div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
  <script>
    particlesJS("particles-js", { particles: { number: { value: 80 }, color: { value: "#00ffff" }, size: { value: 3 }, line_linked: { enable: true, color: "#00ffff", opacity: 0.4 }, move: { speed: 3 } }, interactivity: { events: { onhover: { enable: true, mode: "repulse" } } } });

    let currentUrl = '', currentName = '';

    async function loadFiles() {
      try {
        const res = await fetch('/api/files');
        const files = await res.json();
        const feed = document.getElementById('feed');
        feed.innerHTML = files.length === 0 ? '<p style="grid-column:1/-1;color:#888;">No files uploaded yet</p>' : '';

        files.forEach(f => {
          const card = document.createElement('div');
          card.className = 'card';
          card.onclick = () => openModal(f.url, f.type, f.originalName, f.id);

          let preview = '';
          if (f.type.startsWith('image/')) preview = `<img src="${f.url}" loading="lazy">`;
          else if (f.type.startsWith('video/')) preview = `<video src="${f.url}" controls></video>`;
          else if (f.type.includes('pdf')) preview = `<iframe src="${f.url}"></iframe>`;
          else preview = `<div style="height:250px;display:grid;place-items:center;background:#16213e;"><i class="fas fa-file fa-5x" style="color:var(--primary);"></i></div>`;

          card.innerHTML = `${preview}
            <div class="card-info">
              <div class="card-title">${f.originalName}</div>
              <div class="card-size">${(f.size/1024/1024).toFixed(2)} MB</div>
            </div>`;
          feed.appendChild(card);
        });
      } catch (err) { console.log("Loading..."); }
    }

    function openModal(url, type, name, id) {
      currentUrl = url; currentName = name;
      const content = document.getElementById('modalContent');
      if (type.startsWith('image/')) content.innerHTML = `<img src="${url}">`;
      else if (type.startsWith('video/')) content.innerHTML = `<video src="${url}" controls autoplay></video>`;
      else content.innerHTML = `<iframe src="${url}"></iframe>`;
      document.getElementById('modal').classList.add('active');
    }

    function closeModal() {
      document.getElementById('modal').classList.remove('active');
    }

    function downloadFile() {
      const a = document.createElement('a');
      a.href = currentUrl;
      a.download = currentName;
      a.click();
    }

    async function deleteFile(id) {
      if (confirm("Delete forever?")) {
        await fetch(`/api/files/${id}`, { method: 'DELETE' });
        loadFiles();
      }
    }

    // Upload
    document.getElementById('fileInput').addEventListener('change', async (e) => {
      const file = e.target.files[0];
      if (!file) return;
      const form = new FormData();
      form.append('file', file);
      await fetch('/api/upload', { method: 'POST', body: form });
      loadFiles();
      e.target.value = '';
    });

    // Contact
    document.getElementById('contactForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const data = Object.fromEntries(new FormData(e.target));
      const res = await fetch('/api/contact', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      });
      const result = await res.json();
      document.getElementById('status').textContent = result.message || result.error;
      if (result.success) e.target.reset();
    });

    loadFiles();
    setInterval(loadFiles, 8000);
  </script>
</body>
</html>